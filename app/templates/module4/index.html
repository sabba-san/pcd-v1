{% extends "base.html" %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='module4/css/style.css') }}">

<div class="container-fluid chat-wrapper">
    <div class="row h-100 g-0">
        
        <div class="col-lg-8 d-flex flex-column chat-section">
            
            <div class="chat-header p-3 border-bottom d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-2">
                    <div class="avatar-bot">AI</div>
                    <div>
                        <h5 class="mb-0 fw-bold">Jian Wei (AI Advisor)</h5>
                        <small class="text-success">Online â€¢ Powered by Llama 3</small>
                    </div>
                </div>
                <button class="btn btn-outline-secondary btn-sm d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#toolsSidebar">
                    <i class="bi bi-layout-sidebar-inset-reverse"></i> Tools
                </button>
            </div>

            <div id="chat-box" class="chat-box flex-grow-1 p-4">
                <div class="message bot-message">
                    <div class="message-content">
                        Hello! I am Jian Wei. I can help you understand your Defect Liability Period (DLP) rights or draft legal letters. How can I assist you today?
                    </div>
                    <div class="message-time">Just now</div>
                </div>
            </div>

            <div class="chat-input-area p-3 border-top">
                <form id="chat-form" class="d-flex gap-2">
                    <input type="text" id="user-input" class="form-control" placeholder="Type your question here (e.g., 'My roof is leaking')..." autocomplete="off">
                    <button type="submit" class="btn btn-primary px-4">
                        <i class="bi bi-send-fill"></i>
                    </button>
                </form>
            </div>
        </div>

        <div class="col-lg-4 border-start bg-light tools-section d-none d-lg-block">
            <ul class="nav nav-tabs nav-fill" id="toolTabs" role="tablist">
                <li class="nav-item">
                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#guidelines">Guidelines</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#assessment">Assessment Tool</button>
                </li>
            </ul>

            <div class="tab-content p-3 h-100 overflow-auto">
                <div class="tab-pane fade show active" id="guidelines">
                    <h6 class="fw-bold mb-3">Defect Liability Guidelines</h6>
                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <h6 class="card-title text-primary"><i class="bi bi-book"></i> Legal Basis</h6>
                            <p class="small text-muted mb-0">HDA 1966 & Schedule G/H protect your rights for 24 months from vacant possession.</p>
                        </div>
                    </div>
                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <h6 class="card-title text-danger"><i class="bi bi-exclamation-triangle"></i> Common Issues</h6>
                            <ul class="small text-muted ps-3 mb-0">
                                <li>Wall Cracks (Hairline vs Structural)</li>
                                <li>Water Leakage (Roof/Bathroom)</li>
                                <li>Uneven Flooring</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="assessment">
                    <h6 class="fw-bold mb-3">DLP Eligibility Checker</h6>
                    <form id="assessment-form">
                        <div class="mb-3">
                            <label class="small fw-bold">Defect Type</label>
                            <select class="form-select form-select-sm" id="defectType">
                                <option>Wall Crack</option>
                                <option>Water Leakage</option>
                                <option>Tile Popping</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="small fw-bold">Reported within 24 Months?</label>
                            <select class="form-select form-select-sm" id="withinDLP">
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                        <button type="button" class="btn btn-sm btn-dark w-100" onclick="runAssessment()">Run Assessment</button>
                        <div id="assessment-result" class="mt-3 alert alert-secondary d-none small"></div>
                    </form>
                </div>
            </div>
        </div>

    </div>
</div>
<script src="{{ url_for('static', filename='module4/js/app.js') }}"></script>
{% endblock %}